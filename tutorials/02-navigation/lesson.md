# 第2章: ナビゲーション 🧭

効率的な移動とナビゲーションをマスターしましょう。この章では、より高度な移動テクニックを学びます。

**所要時間**: 30分〜1時間  
**前提**: 第1章の基本操作ができる

---

## 📚 学習内容

1. 効率的なカーソル移動
2. 画面のスクロール
3. 検索とジャンプ
4. マークの活用
5. ウィンドウとバッファの切り替え

---

## ⚡ 効率的なカーソル移動

### 単語・WORD移動（復習+拡張）

```
w  - 次の単語の先頭へ
W  - 次のWORD（空白区切り）の先頭へ
b  - 前の単語の先頭へ
B  - 前のWORDの先頭へ
e  - 次の単語の末尾へ
E  - 次のWORDの末尾へ
```

**単語 vs WORD:**
- 単語: `hello-world` → 3つの単語（hello, -, world）
- WORD: `hello-world` → 1つのWORD

### 行内の高速移動

```
f<文字>  - 行内で次の<文字>へ移動（find）
F<文字>  - 行内で前の<文字>へ移動
t<文字>  - 行内で次の<文字>の手前へ移動（till）
T<文字>  - 行内で前の<文字>の手前へ移動
;        - 直前のf/F/t/Tを繰り返す
,        - 直前のf/F/t/Tを逆方向に繰り返す
```

**例:** `fh` で次の"h"へ、`;` でさらに次の"h"へ

### 括弧のジャンプ

```
%  - 対応する括弧へジャンプ
   (カーソルが括弧の上にある時)
```

対応する括弧: `()`, `[]`, `{}`

---

## 📺 画面のスクロール

### ページ単位

```
Ctrl-f  - 1ページ前進（forward）
Ctrl-b  - 1ページ後退（backward）
Ctrl-d  - 半ページ前進（down）- カーソル中央維持
Ctrl-u  - 半ページ後退（up）- カーソル中央維持
```

### カーソル位置の調整

```
zz  - カーソル行を画面中央へ
zt  - カーソル行を画面上部へ（top）
zb  - カーソル行を画面下部へ（bottom）
```

**よく使う:** `zz` で現在行を中央に！

### 行番号でジャンプ

```
:42       - 42行目へ
42G       - 42行目へ（同じ）
42gg      - 42行目へ（同じ）
```

---

## 🔍 検索とジャンプ

### ファイル内検索

```
/検索語   - 前方検索
?検索語   - 後方検索
n        - 次の検索結果へ（中央表示）
N        - 前の検索結果へ（中央表示）
*        - カーソル下の単語を前方検索
#        - カーソル下の単語を後方検索
ESC      - 検索ハイライトを消す
```

**便利:** カーソルを変数名に置いて `*` を押すと、その変数が使われている場所をすぐ見つけられる！

### 検索のオプション

```vim
:set ignorecase   大文字小文字を区別しない
:set smartcase    大文字が含まれる場合のみ区別
:set hlsearch     検索結果をハイライト
:nohlsearch       ハイライトを一時的に消す（ESCでも可）
```

---

## 🎯 マークの活用

マークは「しおり」のようなもの。長いファイルで特定の場所を記憶できます。

### マークの設定

```
m<文字>  - 現在位置にマークを設定
         例: ma で「aマーク」を設定
```

### マークへジャンプ

```
'<文字>  - マークした行の先頭へ
`<文字>  - マークした正確な位置へ
         例: 'a で「aマーク」の行へ
```

### 特殊なマーク

```
''  - 直前のジャンプ位置へ戻る
`.  - 最後に編集した位置へ
`^  - 最後にInsertモードを抜けた位置へ
```

**使い方例:**
1. `ma` で現在位置を記憶
2. `/function` で関数を検索
3. `'a` で元の位置に戻る

---

## 🪟 ウィンドウとバッファの操作

### ウィンドウ移動（復習）

```
Ctrl-h  - 左のウィンドウへ
Ctrl-j  - 下のウィンドウへ
Ctrl-k  - 上のウィンドウへ
Ctrl-l  - 右のウィンドウへ
```

### ウィンドウ分割

```vim
:split または :sp    横分割
:vsplit または :vs   縦分割
:new                 新しいファイルで横分割
:vnew                新しいファイルで縦分割
```

### バッファ切り替え

```
Shift-h または :bprevious  前のバッファへ
Shift-l または :bnext      次のバッファへ
<Space>fb                   バッファ一覧（Telescope）
<Space>x                    現在のバッファを閉じる
```

---

## 🚀 Telescopeの活用

### ファイル検索

```
<Space>ff  - ファイル名で検索
<Space>fg  - ファイル内容で検索（grep）
<Space>fb  - バッファ一覧
<Space>fr  - 最近使ったファイル
<Space>fh  - ヘルプ検索
```

### Telescope内での操作

```
Ctrl-j / Ctrl-k  - 上下移動
Enter            - 選択して開く
Ctrl-x           - 横分割で開く
Ctrl-v           - 縦分割で開く
ESC              - 閉じる
```

---

## 🎯 実践練習

`practice.txt` を開いて練習しましょう:

```vim
:e ~/.config/nvim/tutorials/02-navigation/practice.txt
```

### 練習問題1: f/t の練習

practice.txtの中で:
1. `fh` で次の"h"を探す
2. `;` で次の"h"へ
3. `ta` で次の"a"の手前へ

### 練習問題2: 検索の練習

1. `/hello` でhelloを検索
2. `n` で次のhelloへ
3. `*` でカーソル下の単語を検索

### 練習問題3: マークの練習

1. `ma` で現在位置をマーク
2. `G` でファイル末尾へ
3. `'a` でマークした位置に戻る

### 練習問題4: 画面スクロール

1. `Ctrl-d` で半ページ下へ
2. `Ctrl-u` で半ページ上へ
3. `zz` でカーソル行を中央へ

---

## 💡 効率化のコツ

### 1. 目的地を見つけてからジャンプ

❌ `jjjjjjjjjj` (10回押す)  
✅ `10j` (1回で10行下へ)  
✅ `/keyword` (検索で一気にジャンプ)

### 2. fとtを使いこなす

```
例: "Hello, world!" の "world" に移動したい
fw  （1回でworldのwにジャンプ！）
```

### 3. *で変数を追跡

カーソルを変数名に置いて `*` → 使用箇所が一目瞭然

### 4. マークで行ったり来たり

長いファイルを編集する時、複数の場所を `ma`, `mb`, `mc` でマーク

---

## 🎓 チートシート

```
=== 高速移動 ===
f<字>      次の<字>へ
;          繰り返し
*          カーソル下の単語を検索
%          対応する括弧へ

=== 画面操作 ===
Ctrl-d     半ページ下
Ctrl-u     半ページ上
zz         カーソル行を中央へ

=== 検索 ===
/word      検索
n          次へ
N          前へ
*          カーソル下の単語

=== マーク ===
ma         aマークを設定
'a         aマークへ
''         直前の位置へ

=== Telescope ===
<Space>ff  ファイル検索
<Space>fg  テキスト検索
<Space>fb  バッファ一覧
```

---

## ✅ 達成目標

- [ ] f/t で行内を高速移動できる
- [ ] 検索（/, *, n）が使える
- [ ] マークで位置を記憶・ジャンプできる
- [ ] 画面スクロール（Ctrl-d/u）が使える
- [ ] Telescopeでファイルを素早く開ける

すべてできたら、**[第3章: 編集操作](../03-editing/)** に進みましょう！ 🚀

---

## 📝 練習のヒント

- 最初は `/` 検索だけでもOK
- fとtは慣れるまで時間がかかる → 焦らず
- Telescopeは超便利 → 積極的に使おう
- マークは長いファイルで威力を発揮
